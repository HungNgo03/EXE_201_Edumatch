<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EDUMATCH Forum</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <link href="assets/css/main.css" rel="stylesheet">
  <style>
    .post-container {
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 5px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      width: 53rem;
    }

    .post-title {
      font-size: 20px;
      font-weight: bold;
    }

    .post-content {
      font-size: 16px;
      line-height: 1.6;
    }

    .post-actions {
      margin-top: 10px;
    }

    .post-actions button {
      background-color: #ff6347;
      color: #fff;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      margin-right: 10px;
    }

    .post-actions button:hover {
      background-color: #e5533d;
    }

    .sidebar {
      background-color: #f8f9fa;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      margin-right: 20px;
    }

    .sidebar h3 {
      font-size: 18px;
      margin-bottom: 15px;
    }

    .sidebar input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    .sidebar select {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    .sidebar button {
      width: 100%;
      padding: 10px;
      background-color: #007bff;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .sidebar button:hover {
      background-color: #0056b3;
    }

    .pagination {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }

    .page-button {
      background-color: #f8f9fa;
      border: 1px solid #ddd;
      color: #333;
      padding: 8px 12px;
      margin: 0 5px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
    }

    .page-button:hover {
      background-color: #007bff;
      color: #fff;
      border-color: #007bff;
    }

    .page-button.active {
      background-color: #007bff;
      color: #fff;
      border-color: #007bff;
    }
  </style>
</head>

<body class="index-page">
  <header id="header" class="header d-flex align-items-center sticky-top">
    <div class="container position-relative d-flex align-items-center justify-content-between">
      <a href="index.html" class="logo d-flex align-items-center me-auto me-xl-0">
        <img src="assets/img/EDUMATCH.jpg" alt="">
        <h1 class="sitename">EDUMATCH</h1>
        <span>.</span>
      </a>
      <nav id="navmenu" class="navmenu">
        <ul>
          <li><a href="#hero" class="active">Home<br></a></li>
          <li><a href="#about">About</a></li>
          <li><a href="forum.html">Di·ªÖn ƒë√†n</a></li>
          <li><a href="findTeacher-page.html">T√¨m Gia S∆∞</a></li>
          <li><a href="payment.html">Payment</a></li>
          <li><a href="#gallery">Gallery</a></li>
          <li class="dropdown"><a href="#"><span>Dropdown</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
            <ul>
              <li><a href="#">Dropdown 1</a></li>
              <li class="dropdown"><a href="#"><span>Deep Dropdown</span> <i
                    class="bi bi-chevron-down toggle-dropdown"></i></a>
                <ul>
                  <li><a href="#">Deep Dropdown 1</a></li>
                  <li><a href="#">Deep Dropdown 2</a></li>
                  <li><a href="#">Deep Dropdown 3</a></li>
                  <li><a href="#">Deep Dropdown 4</a></li>
                  <li><a href="#">Deep Dropdown 5</a></li>
                </ul>
              </li>
              <li><a href="#">Dropdown 2</a></li>
              <li><a href="#">Dropdown 3</a></li>
              <li><a href="#">Dropdown 4</a></li>
            </ul>
          </li>
          <li><a href="#contact">Li√™n h·ªá</a></li>
        </ul>
        <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
      </nav>
      <a id="authButton" class="btn-getstarted" href="#" data-bs-toggle="modal" data-bs-target="#loginModal">ƒêƒÉng
        nh·∫≠p</a>
      <div id="userDropdown" class="d-none dropdown">
        <button class="btn btn-secondary dropdown-toggle username-text" type="button" id="userDropdownButton"
          data-bs-toggle="dropdown" aria-expanded="false">
          T√†i kho·∫£n
        </button>
        <ul class="dropdown-menu" aria-labelledby="userDropdownButton">
          <li><a class="dropdown-item" href="profile.html" id="profileLink">Th√¥ng tin t√†i kho·∫£n</a></li>

          <li><a class="dropdown-item" href="index.html" id="logoutButton">ƒêƒÉng xu·∫•t</a></li>
        </ul>
      </div>

    </div>
  </header>
  <div class="container mt-5 d-flex">
    <div class="sidebar">
      <a class="btn btn-danger" id="addPostButton"
        style="margin-bottom: 2rem; width: 100%; padding: 10px; border: none; border-radius: 5px; cursor: pointer;">
        Th√™m b√†i vi·∫øt m·ªõi</a>
      <h3>B·ªô l·ªçc b√†i vi·∫øt</h3>
      <input type="text" placeholder="T√¨m ki·∫øm..." id="search-input">
      <select id="subject-select">
        <option value="">Ch·ªçn m√¥n h·ªçc</option>
      </select>
      <button id="search-button">T√¨m ki·∫øm</button>
    </div>
    <div class="content" id="post-container">
      <!-- Posts will be dynamically inserted here -->
    </div>
  </div>

  <!-- Pagination -->
  <div class="pagination" id="pagination-container">
    <!-- Pagination buttons will be dynamically inserted here -->
  </div>

  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/js/main.js"></script>
  <script type="module">
    import Post from './Post.js';

    document.addEventListener('DOMContentLoaded', function () {
      const postContainer = document.getElementById('post-container');
      const searchInput = document.getElementById('search-input');
      const searchButton = document.getElementById('search-button');
      const subjectSelect = document.getElementById('subject-select');
      const paginationContainer = document.getElementById('pagination-container');

      let currentPage = 0;
      const pageSize = 5;
      let currentUrl = 'http://localhost:8080/Post/getAllPost1';

      function fetchPaginatedPosts(url, pageNo = 0, pageSize = 5) {
        console.log("Fetching paginated posts from URL:", url); // Debugging URL
        fetch(`${url}?pageNo=${pageNo}&pageSize=${pageSize}`)
          .then(response => response.json())
          .then(data => {
            console.log("API Response:", data);
            postContainer.innerHTML = '';

            if (data.result && data.result.content && Array.isArray(data.result.content) && data.result.content.length > 0) {
              data.result.content.forEach(postData => {
                const post = new Post(
                  postData.id,
                  postData.userID,
                  postData.username,
                  postData.subjectID,
                  postData.subjectname,
                  postData.title,
                  postData.content,
                  postData.rating,
                  postData.createdAt,
                  postData.updatedAt
                );
                const postElement = createPostElement(post);
                postContainer.appendChild(postElement);
              });
              updatePagination(data.result.totalPages, pageNo);
            } else {
              postContainer.innerHTML = '<p>Kh√¥ng c√≥ k·∫øt qu·∫£ n√†o ƒë∆∞·ª£c hi·ªÉn th·ªã</p>';
              console.error("Data.result is not an array or is empty:", data.result);
            }
          })
          .catch(error => console.error('Error fetching posts:', error));
      }

      function fetchAllPosts(url) {
        console.log("Fetching all posts from URL:", url);
        fetch(url)
          .then(response => response.json())
          .then(data => {
            console.log("API Response:", data);
            postContainer.innerHTML = '';

            if (data.result && Array.isArray(data.result)) {
              data.result.forEach(postData => {
                const post = new Post(
                  postData.id,
                  postData.userID,
                  postData.username,
                  postData.subjectID,
                  postData.subjectname,
                  postData.title,
                  postData.content,
                  postData.rating,
                  postData.createdAt,
                  postData.updatedAt
                );
                const postElement = createPostElement(post);
                postContainer.appendChild(postElement);
              });
              paginationContainer.innerHTML = ''; // Remove pagination
            } else {
              postContainer.innerHTML = '<p>Kh√¥ng c√≥ k·∫øt qu·∫£ n√†o ƒë∆∞·ª£c hi·ªÉn th·ªã</p>';
              console.error("Data.result is not an array or is empty:", data.result);
            }
          })
          .catch(error => console.error('Error fetching posts:', error));
      }

      function createPostElement(post) {
        const postElement = document.createElement('div');
        postElement.classList.add('post-container');
        postElement.innerHTML = `
                  <div class="post-user">Ng∆∞·ªùi t·∫°o b√†i vi·∫øt: ${post.username}</div>
                  <div class="post-subject">M√¥n h·ªçc: ${post.subjectname}</div>
                  <div class="post-title">Ti√™u ƒë·ªÅ b√†i vi·∫øt: ${post.title}</div>
                  <div class="post-content">${post.content}</div>
                  <div class="post-rating">S·ªë sao ƒë√°nh gi√°: ${post.rating}</div>
                  <div class="post-created-at">Ng√†y t·∫°o b√†i vi·∫øt: ${post.createdAt}</div>
                  <div class="post-updated-at">Ng√†y c·∫≠p nh·∫≠t b√†i vi·∫øt: ${post.updatedAt}</div>
                  <div class="post-actions">
                      <button><i class="fas fa-thumbs-up"></i> Like</button>
                      <button><i class="fas fa-comment"></i> Comment</button>
                  </div>
              `;
        return postElement;
      }

      function fetchSubjects() {
        fetch('http://localhost:8080/Post/getAllSubject')
          .then(response => response.json())
          .then(data => {
            console.log("Subjects API Response:", data);
            if (data.result && Array.isArray(data.result)) {
              data.result.forEach(subject => {
                const option = document.createElement('option');
                option.value = subject;
                option.textContent = subject;
                subjectSelect.appendChild(option);
              });
            } else {
              postContainer.innerHTML = '<p>Kh√¥ng c√≥ k·∫øt qu·∫£ n√†o ƒë∆∞·ª£c hi·ªÉn th·ªã</p>';
              console.error("Data.result is not an array:", data.result);
            }
          })
          .catch(error => console.error('Error fetching subjects:', error));
      }

      function updatePagination(totalPages, currentPage) {
        paginationContainer.innerHTML = '';
        for (let i = 0; i < totalPages; i++) {
          const pageButton = document.createElement('button');
          pageButton.textContent = i + 1;
          pageButton.classList.add('page-button');
          if (i === currentPage) {
            pageButton.classList.add('active');
          }
          pageButton.addEventListener('click', () => {
            currentPage = i;
            fetchPaginatedPosts(currentUrl, currentPage, pageSize);
          });
          paginationContainer.appendChild(pageButton);
        }
      }

      // Fetch all posts on page load
      fetchPaginatedPosts(currentUrl, currentPage, pageSize);
      // Fetch all subjects on page load
      fetchSubjects();

      // Search event listener
      searchButton.addEventListener('click', function () {
        const username = searchInput.value;
        const subjectname = subjectSelect.value;
        let url = 'http://localhost:8080/Post/getAllPost'; // Default to getAllPost for search

        if (username && subjectname) {
          url = `http://localhost:8080/Post/findPostsBySubjectAndUsername?subjectname=${subjectname}&username=${username}`;
        } else if (username) {
          url = `http://localhost:8080/Post/findPostsByUsername?username=${username}`;
        } else if (subjectname) {
          url = `http://localhost:8080/Post/findPostsBySubject?subjectname=${subjectname}`;
        }

        currentUrl = url;
        fetchAllPosts(currentUrl);
      });
    });
  </script>
  <!-- Modal for adding post -->
  <div class="modal fade" id="addPostModal" tabindex="-1" aria-labelledby="addPostModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content shadow-lg border-0 rounded-4">
        <div class="modal-header border-0 bg-danger text-white text-center">
          <h2 class="modal-title w-100 fw-bold display-5" id="addPostModalLabel">Th√™m b√†i vi·∫øt m·ªõi</h2>
          <button type="button" class="btn-close btn-close-white position-absolute end-0 me-3" data-bs-dismiss="modal"
            aria-label="Close"></button>
        </div>
        <div class="modal-body p-5">
          <form id="addPostForm">
            <div class="mb-3">
              <label for="postTitle" class="form-label fw-semibold">Ti√™u ƒë·ªÅ</label>
              <input type="text" class="form-control rounded-3 p-2" id="postTitle" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ" required>
            </div>
            <div class="mb-3">
              <label for="postContent" class="form-label fw-semibold">N·ªôi dung</label>
              <textarea class="form-control rounded-3 p-2" id="postContent" rows="5" placeholder="Nh·∫≠p n·ªôi dung"
                required></textarea>
            </div>
            <div class="mb-3">
              <label for="modal-subject-select" class="form-label fw-semibold">Ch·ªçn m√¥n h·ªçc</label>
              <select class="form-control rounded-3 p-2" id="modal-subject-select" required>
                <option value="">Ch·ªçn m√¥n h·ªçc</option>
              </select>
            </div>
            <button type="submit" class="btn w-100 py-2 rounded-3 text-white" style="background-color: #CE1212;">ƒêƒÉng
              b√†i vi·∫øt</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  <!-- Login/Register Modal -->
  <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content shadow-lg border-0 rounded-4">
        <div class="modal-header border-0 bg-danger text-white text-center">
          <h2 class="modal-title w-100 fw-bold display-5" id="loginModalLabel">üéâ Ch√†o m·ª´ng b·∫°n! üéâ</h2>
          <button type="button" class="btn-close btn-close-white position-absolute end-0 me-3" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body p-5">
          <!-- Tabs for Login & Register -->
          <ul class="nav nav-pills nav-justified mb-3" id="loginRegisterTabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active fw-bold" id="login-tab" data-bs-toggle="tab" data-bs-target="#login" type="button" role="tab">ƒêƒÉng nh·∫≠p</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link fw-bold" id="register-tab" data-bs-toggle="tab" data-bs-target="#register" type="button" role="tab">ƒêƒÉng k√Ω</button>
            </li>
          </ul>
  
          <div class="tab-content mt-3">
            <!-- Login Form -->
            <div class="tab-pane fade show active" id="login" role="tabpanel">
              <form id="loginForm" class="d-flex flex-column align-items-center">
                <div class="mb-3 w-50 text-start">
                  <label for="loginUsername" class="form-label fw-semibold">Username</label>
                  <input type="text" class="form-control rounded-3 p-2" id="loginUsername" name="username" placeholder="Nh·∫≠p username" required>
                </div>
                <div class="mb-3 w-50 text-start">
                  <label for="loginPassword" class="form-label fw-semibold">M·∫≠t kh·∫©u</label>
                  <input type="password" class="form-control rounded-3 p-2" id="loginPassword" name="password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" required>
                </div>
                <button type="submit" class="btn text-white rounded-3 mt-2 px-4 py-2" style="background-color: #CE1212;">ƒêƒÉng nh·∫≠p</button>
                <p class="mt-2">
                  <a href="#" id="forgotPasswordLink" class="text-decoration-none">Qu√™n m·∫≠t kh·∫©u?</a>
                </p>
              </form>
  
  
            </div>
  
            <!-- Modal Qu√™n M·∫≠t Kh·∫©u -->
            <div class="modal fade" id="forgotPasswordModal" tabindex="-1" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title">Qu√™n M·∫≠t Kh·∫©u</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                  </div>
                  <div class="modal-body">
                    <input type="email" id="forgotEmail" class="form-control mb-2" placeholder="Nh·∫≠p email">
                    <button id="sendOtpBtn" class="btn btn-primary w-100">G·ª≠i OTP</button>
  
                    <div id="otpSection" style="display:none;">
                      <input type="text" id="otpCode" class="form-control mt-3" placeholder="Nh·∫≠p m√£ OTP">
                      <input type="password" id="newPassword" class="form-control mt-2" placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi">
                      <button id="resetPasswordBtn" class="btn btn-success w-100 mt-2">ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
  
            <!-- Register Form -->
            <div class="tab-pane fade" id="register" role="tabpanel">
              <form id="registerForm">
                <div class="row">
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="registerName" class="form-label fw-semibold">H·ªç v√† T√™n</label>
                      <input type="text" class="form-control rounded-3 p-2" id="registerName" placeholder="Nh·∫≠p h·ªç t√™n" required>
                    </div>
                    <div class="mb-3">
                      <label for="registerPhone" class="form-label fw-semibold">S·ªë ƒëi·ªán tho·∫°i</label>
                      <input type="tel" class="form-control rounded-3 p-2" id="registerPhone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" required>
                    </div>
                    <div class="mb-3">
                      <label for="registerEmail" class="form-label fw-semibold">Email</label>
                      <input type="email" class="form-control rounded-3 p-2" id="registerEmail" placeholder="Nh·∫≠p email" required>
                    </div>
                  </div>
  
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="registerPassword" class="form-label fw-semibold">M·∫≠t kh·∫©u</label>
                      <input type="password" class="form-control rounded-3 p-2" id="registerPassword" placeholder="T·∫°o m·∫≠t kh·∫©u" required>
                    </div>
                    <div class="mb-3">
                      <label for="username" class="form-label fw-semibold">Username</label>
                      <input type="text" class="form-control rounded-3 p-2" id="username" placeholder="Nh·∫≠p username" required>
                    </div>
                    <div class="mb-3">
                      <label for="registerRole" class="form-label fw-semibold">Ch·ªçn vai tr√≤</label>
                      <select class="form-control rounded-3 p-2" id="registerRole" required>
                        <option value="" selected></option>
                        <option value="Student">Student</option>
                        <option value="Tutor">Tutor</option>
                      </select>
                    </div>
  
  
                    <!-- Tr∆∞·ªùng d√†nh cho Tutor -->
                    <div id="tutorFields" style="display: none;">
                      <div class="mb-3">
                        <label for="gender" class="form-label fw-semibold">Gi·ªõi t√≠nh</label>
                        <select class="form-control rounded-3 p-2" id="gender">
                          <option value="0">Nam</option>
                          <option value="1">N·ªØ</option>
                        </select>
                      </div>
                      <div class="mb-3">
                        <label for="dateOfBirth" class="form-label fw-semibold">Ng√†y sinh</label>
                        <input type="date" class="form-control rounded-3 p-2" id="dateOfBirth">
                      </div>
                      <div class="mb-3">
                        <label for="address" class="form-label fw-semibold">ƒê·ªãa ch·ªâ</label>
                        <input type="text" class="form-control rounded-3 p-2" id="address" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ">
                      </div>
                      <div class="mb-3">
                        <label for="qualification" class="form-label fw-semibold">B·∫±ng c·∫•p</label>
                        <input type="text" class="form-control rounded-3 p-2" id="qualification" placeholder="Nh·∫≠p b·∫±ng c·∫•p">
                      </div>
                      <div class="mb-3">
                        <label for="experience" class="form-label fw-semibold">Kinh nghi·ªám (nƒÉm)</label>
                        <input type="number" class="form-control rounded-3 p-2" id="experience" min="0" placeholder="Nh·∫≠p s·ªë nƒÉm kinh nghi·ªám">
                      </div>
                      <div class="mb-3">
                        <label for="bio" class="form-label fw-semibold">Gi·ªõi thi·ªáu</label>
                        <textarea class="form-control rounded-3 p-2" id="bio" placeholder="Gi·ªõi thi·ªáu b·∫£n th√¢n"></textarea>
                      </div>
                    </div>
  
                    <!-- Tr∆∞·ªùng d√†nh cho Student -->
                    <div id="studentFields" style="display: none;">
                      <div class="mb-3">
                        <label for="parentName" class="form-label fw-semibold">T√™n ph·ª• huynh</label>
                        <input type="text" class="form-control rounded-3 p-2" id="parentName" placeholder="Nh·∫≠p t√™n ph·ª• huynh">
                      </div>
                      <div class="mb-3">
                        <label for="grade" class="form-label fw-semibold">L·ªõp h·ªçc</label>
                        <input type="text" class="form-control rounded-3 p-2" id="grade" placeholder="Nh·∫≠p l·ªõp h·ªçc">
                      </div>
                      <div class="mb-3">
                        <label for="addressStudent" class="form-label fw-semibold">ƒê·ªãa ch·ªâ</label>
                        <input type="text" class="form-control rounded-3 p-2" id="addressStudent" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ">
                      </div>
                      <div class="mb-3">
                        <label for="notes" class="form-label fw-semibold">Ghi ch√∫</label>
                        <textarea class="form-control rounded-3 p-2" id="notes" placeholder="Nh·∫≠p ghi ch√∫ (n·∫øu c√≥)"></textarea>
                      </div>
                    </div>
  
                  </div>
                </div>
  
                <button type="submit" class="btn w-100 py-2 rounded-3 text-white" style="background-color: #CE1212;">ƒêƒÉng k√Ω</button>
              </form>
            </div>
  
          </div>
        </div>
      </div>
    </div>
  </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const registerForm = document.querySelector("#registerForm");
        const loginRegisterTabs = new bootstrap.Tab(document.querySelector("#login-tab"));
  
        registerForm.addEventListener("submit", async function (event) {
          event.preventDefault();
  
          // L·∫•y d·ªØ li·ªáu t·ª´ form
          const fullname = document.getElementById("registerName").value;
          const phoneNumber = document.getElementById("registerPhone").value;
          const email = document.getElementById("registerEmail").value;
          const password = document.getElementById("registerPassword").value;
          const username = document.getElementById("username").value;
          const role = document.getElementById("registerRole").value;
  
          // Ki·ªÉm tra m·∫≠t kh·∫©u c√≥ kh·ªõp kh√¥ng
          if (password.length < 6) {
            Swal.fire({
              title: "L·ªói!",
              text: "M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±!",
              icon: "error",
              confirmButtonText: "Th·ª≠ l·∫°i"
            });
            return;
          }
  
          // T·∫°o ƒë·ªëi t∆∞·ª£ng d·ªØ li·ªáu g·ª≠i ƒëi
          let requestBody = {
            username: username,
            fullname: fullname,
            phoneNumber: phoneNumber,
            email: email,
            password: password,
            role: role
          };
  
          // N·∫øu role l√† Tutor, th√™m th√¥ng tin Tutor
          if (role === "Tutor") {
            requestBody.gender = document.getElementById("gender").value === "1";
            requestBody.dateOfBirth = document.getElementById("dateOfBirth").value;
            requestBody.address = document.getElementById("address").value;
            requestBody.qualification = document.getElementById("qualification").value;
            requestBody.experience = document.getElementById("experience").value;
            requestBody.bio = document.getElementById("bio").value;
          }
  
          // N·∫øu role l√† Student, th√™m th√¥ng tin Student
          if (role === "Student") {
            requestBody.parentName = document.getElementById("parentName").value;
            requestBody.grade = document.getElementById("grade").value;
            requestBody.address = document.getElementById("addressStudent").value;
            requestBody.notes = document.getElementById("notes").value;
          }
  
          // Ki·ªÉm tra log d·ªØ li·ªáu g·ª≠i ƒëi
          console.log("D·ªØ li·ªáu g·ª≠i l√™n:", JSON.stringify(requestBody, null, 2));
  
          // G·ª≠i request ƒë·∫øn backend
          const response = await fetch("http://localhost:8080/users/register", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(requestBody),
          });
  
          const result = await response.text();
          if (response.ok) {
            Swal.fire({
              title: "ƒêƒÉng k√Ω th√†nh c√¥ng!",
              text: "B√¢y gi·ªù b·∫°n c√≥ th·ªÉ ƒëƒÉng nh·∫≠p.",
              icon: "success",
              confirmButtonText: "ƒêƒÉng nh·∫≠p ngay"
            }).then(() => {
              registerForm.reset();
              loginRegisterTabs.show();
            });
          } else {
            Swal.fire({
              title: "L·ªói!",
              text: result,
              icon: "error",
              confirmButtonText: "Th·ª≠ l·∫°i"
            });
          }
        });
      });
  
  
    </script>
    <script>
    document.addEventListener("DOMContentLoaded", function () {
    const forgotPasswordLink = document.getElementById("forgotPasswordLink");
    const forgotPasswordModal = new bootstrap.Modal(document.getElementById("forgotPasswordModal"));
  
    forgotPasswordLink.addEventListener("click", function (event) {
    event.preventDefault(); // NgƒÉn ch·∫∑n chuy·ªÉn h∆∞·ªõng trang
    forgotPasswordModal.show(); // M·ªü modal qu√™n m·∫≠t kh·∫©u
      });
    });
    </script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const addPostButton = document.getElementById("addPostButton");
      const addPostModal = new bootstrap.Modal(document.getElementById('addPostModal'));
      const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));

      addPostButton.addEventListener("click", function (event) {
        const user = JSON.parse(localStorage.getItem("user"));
        if (!user) {
          event.preventDefault();
          Swal.fire({
            icon: 'warning',
            title: 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ th√™m b√†i vi·∫øt.',
            showConfirmButton: true
          });
          loginModal.show();
          return;
        }
        addPostModal.show();
      });

      const addPostForm = document.querySelector("#addPostForm");

      addPostForm.addEventListener("submit", async function (event) {
        event.preventDefault();

        // L·∫•y d·ªØ li·ªáu t·ª´ form
        const title = document.getElementById("postTitle").value;
        const content = document.getElementById("postContent").value;
        const subjectID = document.getElementById("modal-subject-select").value;
        const user = JSON.parse(localStorage.getItem("user"));
        if (!user) {
          Swal.fire({
            icon: 'warning',
            title: 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ th√™m b√†i vi·∫øt.',
            showConfirmButton: true
          });
          loginModal.show();
          return;
        }

        const userID = user.userId;

        // G·ª≠i request ƒë·∫øn backend
        const response = await fetch("http://localhost:8080/Post/addPost", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            UserID: userID,
            SubjectID: subjectID,
            Title: title,
            Content: content,
            Rating: 5
          }),
        });

        const result = await response.json();
        if (response.ok) {
          Swal.fire({
            icon: 'success',
            title: 'B√†i vi·∫øt ƒë√£ ƒë∆∞·ª£c th√™m th√†nh c√¥ng!',
            showConfirmButton: false,
            timer: 1500
          }).then(() => {
            addPostForm.reset();
            addPostModal.hide();
            location.reload();
          });
        } else {
          Swal.fire({
            icon: 'error',
            title: 'L·ªói',
            text: result.message,
            showConfirmButton: true
          });
          console.error("Error details:", result);
        }
      });

      // Fetch subjects and populate the subject select dropdown
      fetch('http://localhost:8080/Post/getAllSubject2')
        .then(response => response.json())
        .then(data => {
          const subjectSelect = document.getElementById("modal-subject-select");
          if (data.result && Array.isArray(data.result)) {
            data.result.forEach(subject => {
              const option = document.createElement('option');
              option.value = subject.id; // S·ª≠ d·ª•ng SubjectID l√†m gi√° tr·ªã
              option.textContent = subject.subjectname; // Hi·ªÉn th·ªã SubjectName
              console.log("Subject Option: ", option); // Debugging option
              subjectSelect.appendChild(option);
            });
          } else {
            console.error("Data.result is not an array:", data.result);
          }
        })
        .catch(error => console.error('Error fetching subjects:', error));
    });
  </script>

  <footer id="footer" class="footer dark-background">
    <div class="container">
      <div class="row gy-3">
        <div class="col-lg-3 col-md-6 d-flex">
          <i class="bi bi-geo-alt icon"></i>
          <div class="address">
            <h4>Address</h4>
            <p>A108 Adam Street</p>
            <p>New York, NY 535022</p>
            <p></p>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 d-flex">
          <i class="bi bi-telephone icon"></i>
          <div>
            <h4>Contact</h4>
            <p>
              <strong>Phone:</strong> <span>+1 5589 55488 55</span><br>
              <strong>Email:</strong> <span>info@example.com</span><br>
            </p>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 d-flex">
          <i class="bi bi-clock icon"></i>
          <div>
            <h4>Opening Hours</h4>
            <p>
              <strong>Mon-Sat:</strong> <span>11AM - 23PM</span><br>
              <strong>Sunday</strong>: <span>Closed</span>
            </p>
          </div>
        </div>
        <div class="col-lg-3 col-md-6">
          <h4>Follow Us</h4>
          <div class="social-links d-flex">
            <a href="#" class="twitter"><i class="bi bi-twitter-x"></i></a>
            <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
            <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
            <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
          </div>
        </div>
      </div>
    </div>
    <div class="container copyright text-center mt-4">
      <p>¬© <span>Copyright</span> <strong class="px-1 sitename">Yummy</strong> <span>All Rights Reserved</span>
      </p>
      <div class="credits">
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you've purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: [buy-url] -->
        Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a> Distributed by <a
          href="https://themewagon.com">ThemeWagon</a>
      </div>
    </div>
  </footer>
  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i
      class="bi bi-arrow-up-short"></i></a>
  <!-- Preloader -->
  <div id="preloader"></div>
  <!-- Vendor JS Files -->
  <script src="assets/js/auth.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <!-- Main JS File -->
  <script src="assets/js/main.js"></script>
  <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js">
  </script>

</html>