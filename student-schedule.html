<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>EDUMATCH</title>
    <meta name="description" content="">
    <meta name="keywords" content="">

    <!-- Favicons -->
    <link href="assets/img/favicon.png" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Inter:wght@100;200;300;400;500;600;700;800;900&family=Amatic+SC:wght@400;700&display=swap"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

    <!-- Main CSS File -->
    <link href="assets/css/main.css" rel="stylesheet">
    <style>
        .main-container {
            padding: 20px;
            padding-bottom: 100px;
        }

        h3.text-center {
            font-family: initial;
            font-weight: normal;
        }

        table {
            width: 100%;
            /* ƒê·∫£m b·∫£o b·∫£ng chi·∫øm 100% chi·ªÅu r·ªông c·ªßa container */
            table-layout: fixed;
            /* Gi√∫p ƒëi·ªÅu ch·ªânh c√°c c·ªôt ƒë·ªÅu */
        }

        table th,
        table td {
            font-size: 14px;
            /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ xu·ªëng 14px, b·∫°n c√≥ th·ªÉ thay ƒë·ªïi gi√° tr·ªã n√†y */
            padding: 10px;
            /* ƒêi·ªÅu ch·ªânh kho·∫£ng c√°ch b√™n trong √¥ */
            text-align: center;
        }

        table th:nth-child(1),
        table td:nth-child(1) {
            width: 15%;
            /* C·ªôt MON */
        }

        table th:nth-child(2),
        table td:nth-child(2) {
            width: 15%;
            /* C·ªôt TUE */
        }

        table th:nth-child(3),
        table td:nth-child(3) {
            width: 15%;
            /* C·ªôt WED */
        }

        table th:nth-child(3),
        table td:nth-child(3) {
            width: 15%;
            /* C·ªôt Thurs */
        }

        table th:nth-child(3),
        table td:nth-child(3) {
            width: 15%;
            /* C·ªôt fri */
        }

        table th:nth-child(3),
        table td:nth-child(3) {
            width: 15%;
            /* C·ªôt sat */
        }

        table th:nth-child(3),
        table td:nth-child(3) {
            width: 15%;
            /* C·ªôt cn */
        }
    </style>
</head>


<body>
    <header id="header" class="header d-flex align-items-center sticky-top">
        <div class="container position-relative d-flex align-items-center justify-content-between">
    
          <a href="index.html" class="logo d-flex align-items-center me-auto me-xl-0">
            <!-- Uncomment the line below if you also wish to use an image logo -->
            <img src="assets/img/EDUMATCH.jpg" alt="">
            <h1 class="sitename">EDUMATCH</h1>
            <span>.</span>
          </a>
    
          <nav id="navmenu" class="navmenu">
            <ul>
              <li><a href="index.html" class="active">Trang ch·ªß<br></a></li>
              <li><a href="forum.html">Di·ªÖn ƒë√†n</a></li>
              <li><a href="chat.html">Tr√≤ chuy·ªán</a></li>
              <li><a href="findTeacher-page.html">T√¨m Gia S∆∞</a></li>
              <li class="dropdown"><a href="#"><span>L·ªõp h·ªçc</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
                <ul>
                  <li><a href="class-list.html">Danh s√°ch l·ªõp h·ªçc</a></li>
                  <li><a href="register-class-list.html">Danh s√°ch ƒëƒÉng k√Ω</a></li>
                </ul>
              </li>
              <li><a href="student-schedule.html" id="scheduleLink">Th·ªùi kh√≥a bi·ªÉu</a></li>
    
              <li><a href="#contact">Li√™n h·ªá</a></li>
            </ul>
            <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
          </nav>
    
          <a id="authButton" class="btn-getstarted" href="#" data-bs-toggle="modal" data-bs-target="#loginModal">ƒêƒÉng
            nh·∫≠p</a>
          <div id="userDropdown" class="d-none dropdown">
            <button class="btn btn-secondary dropdown-toggle username-text" type="button" id="userDropdownButton"
              data-bs-toggle="dropdown" aria-expanded="false">
              T√†i kho·∫£n
            </button>
            <ul class="dropdown-menu" aria-labelledby="userDropdownButton">
              <li><a class="dropdown-item" href="profile.html" id="profileLink">Th√¥ng tin t√†i kho·∫£n</a></li>
    
              <li><a class="dropdown-item" href="index.html" id="logoutButton">ƒêƒÉng xu·∫•t</a></li>
            </ul>
          </div>
    
        </div>
      </header>
    <main class="container mt-4 main-container">
        <div class="container mt-4">
            <div class="row">
                <!-- Th·ªùi kh√≥a bi·ªÉu -->
                <div class="col-md-12">
                    <h3 class="text-center">Th·ªùi Kh√≥a Bi·ªÉu</h3>
                    <div class="d-flex align-items-center mb-3">
                        <label for="year-select" class="me-2 fw-bold text-danger">YEAR</label>
                        <select id="year-select" class="form-select me-3" style="width: 100px;">
                            <!-- Danh s√°ch nƒÉm s·∫Ω ƒë∆∞·ª£c t·∫°o b·∫±ng JavaScript -->
                        </select>

                        <label for="week-select" class="me-2 fw-bold">WEEK</label>
                        <select id="week-select" class="form-select" style="width: 200px;">
                            <!-- Danh s√°ch tu·∫ßn s·∫Ω ƒë∆∞·ª£c t·∫°o b·∫±ng JavaScript -->
                        </select>
                    </div>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>MON (24/02)</th>
                                <th>TUE (25/02)</th>
                                <th>WED (26/02)</th>
                                <th>THU (27/02)</th>
                                <th>FRI (28/02)</th>
                                <th>SAT (01/03)</th>
                                <th>SUN (02/03)</th>
                            </tr>
                        </thead>
                        <tbody id="schedule-body">
                            <!-- D·ªØ li·ªáu l·ªãch h·ªçc s·∫Ω ƒë∆∞·ª£c t·∫£i t·ª´ API -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- Login/Register Modal -->
        <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-xl">
                <div class="modal-content shadow-lg border-0 rounded-4">
                    <div class="modal-header border-0 bg-danger text-white text-center">
                        <h2 class="modal-title w-100 fw-bold display-5" id="loginModalLabel">üéâ Ch√†o m·ª´ng b·∫°n! üéâ</h2>
                        <button type="button" class="btn-close btn-close-white position-absolute end-0 me-3"
                            data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body p-5">
                        <!-- Tabs for Login & Register -->
                        <ul class="nav nav-pills nav-justified mb-3" id="loginRegisterTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active fw-bold" id="login-tab" data-bs-toggle="tab"
                                    data-bs-target="#login" type="button" role="tab">ƒêƒÉng nh·∫≠p</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link fw-bold" id="register-tab" data-bs-toggle="tab"
                                    data-bs-target="#register" type="button" role="tab">ƒêƒÉng k√Ω</button>
                            </li>
                        </ul>

                        <div class="tab-content mt-3">
                            <!-- Login Form -->
                            <div class="tab-pane fade show active" id="login" role="tabpanel">
                                <form id="loginForm" class="d-flex flex-column align-items-center">
                                    <div class="mb-3 w-50 text-start">
                                        <label for="loginUsername" class="form-label fw-semibold">Username</label>
                                        <input type="text" class="form-control rounded-3 p-2" id="loginUsername"
                                            name="username" placeholder="Nh·∫≠p username" required>
                                    </div>
                                    <div class="mb-3 w-50 text-start">
                                        <label for="loginPassword" class="form-label fw-semibold">M·∫≠t kh·∫©u</label>
                                        <input type="password" class="form-control rounded-3 p-2" id="loginPassword"
                                            name="password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" required>
                                    </div>
                                    <button type="submit" class="btn text-white rounded-3 mt-2 px-4 py-2"
                                        style="background-color: #CE1212;">ƒêƒÉng nh·∫≠p</button>
                                    <p class="mt-2">
                                        <a href="#" id="forgotPasswordLink" class="text-decoration-none">Qu√™n m·∫≠t
                                            kh·∫©u?</a>
                                    </p>
                                </form>


                            </div>

                            <!-- Modal Qu√™n M·∫≠t Kh·∫©u -->
                            <div class="modal fade" id="forgotPasswordModal" tabindex="-1" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Qu√™n M·∫≠t Kh·∫©u</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>
                                        <div class="modal-body">
                                            <input type="email" id="forgotEmail" class="form-control mb-2"
                                                placeholder="Nh·∫≠p email">
                                            <button id="sendOtpBtn" class="btn btn-primary w-100">G·ª≠i OTP</button>

                                            <div id="otpSection" style="display:none;">
                                                <input type="text" id="otpCode" class="form-control mt-3"
                                                    placeholder="Nh·∫≠p m√£ OTP">
                                                <input type="password" id="newPassword" class="form-control mt-2"
                                                    placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi">
                                                <button id="resetPasswordBtn" class="btn btn-success w-100 mt-2">ƒê·∫∑t l·∫°i
                                                    m·∫≠t kh·∫©u</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Register Form -->
                            <div class="tab-pane fade" id="register" role="tabpanel">
                                <form id="registerForm">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="registerName" class="form-label fw-semibold">H·ªç v√†
                                                    T√™n</label>
                                                <input type="text" class="form-control rounded-3 p-2" id="registerName"
                                                    placeholder="Nh·∫≠p h·ªç t√™n" required>
                                            </div>
                                            <div class="mb-3">
                                                <label for="registerPhone" class="form-label fw-semibold">S·ªë ƒëi·ªán
                                                    tho·∫°i</label>
                                                <input type="tel" class="form-control rounded-3 p-2" id="registerPhone"
                                                    placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" required>
                                            </div>
                                            <div class="mb-3">
                                                <label for="registerEmail" class="form-label fw-semibold">Email</label>
                                                <input type="email" class="form-control rounded-3 p-2"
                                                    id="registerEmail" placeholder="Nh·∫≠p email" required>
                                            </div>
                                        </div>

                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="registerPassword" class="form-label fw-semibold">M·∫≠t
                                                    kh·∫©u</label>
                                                <input type="password" class="form-control rounded-3 p-2"
                                                    id="registerPassword" placeholder="T·∫°o m·∫≠t kh·∫©u" required>
                                            </div>
                                            <div class="mb-3">
                                                <label for="username" class="form-label fw-semibold">Username</label>
                                                <input type="text" class="form-control rounded-3 p-2" id="username"
                                                    placeholder="Nh·∫≠p username" required>
                                            </div>
                                            <div class="mb-3">
                                                <label for="registerRole" class="form-label fw-semibold">Ch·ªçn vai
                                                    tr√≤</label>
                                                <select class="form-control rounded-3 p-2" id="registerRole" required>
                                                    <option value="" selected></option>
                                                    <option value="Student">Student</option>
                                                    <option value="Tutor">Tutor</option>
                                                </select>
                                            </div>


                                            <!-- Tr∆∞·ªùng d√†nh cho Tutor -->
                                            <div id="tutorFields" style="display: none;">
                                                <div class="mb-3">
                                                    <label for="gender" class="form-label fw-semibold">Gi·ªõi t√≠nh</label>
                                                    <select class="form-control rounded-3 p-2" id="gender">
                                                        <option value="0">Nam</option>
                                                        <option value="1">N·ªØ</option>
                                                    </select>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="dateOfBirth" class="form-label fw-semibold">Ng√†y
                                                        sinh</label>
                                                    <input type="date" class="form-control rounded-3 p-2"
                                                        id="dateOfBirth">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="address" class="form-label fw-semibold">ƒê·ªãa ch·ªâ</label>
                                                    <input type="text" class="form-control rounded-3 p-2" id="address"
                                                        placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="qualification" class="form-label fw-semibold">B·∫±ng
                                                        c·∫•p</label>
                                                    <input type="text" class="form-control rounded-3 p-2"
                                                        id="qualification" placeholder="Nh·∫≠p b·∫±ng c·∫•p">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="experience" class="form-label fw-semibold">Kinh nghi·ªám
                                                        (nƒÉm)</label>
                                                    <input type="number" class="form-control rounded-3 p-2"
                                                        id="experience" min="0" placeholder="Nh·∫≠p s·ªë nƒÉm kinh nghi·ªám">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="bio" class="form-label fw-semibold">Gi·ªõi thi·ªáu</label>
                                                    <textarea class="form-control rounded-3 p-2" id="bio"
                                                        placeholder="Gi·ªõi thi·ªáu b·∫£n th√¢n"></textarea>
                                                </div>
                                            </div>

                                            <!-- Tr∆∞·ªùng d√†nh cho Student -->
                                            <div id="studentFields" style="display: none;">
                                                <div class="mb-3">
                                                    <label for="parentName" class="form-label fw-semibold">T√™n ph·ª•
                                                        huynh</label>
                                                    <input type="text" class="form-control rounded-3 p-2"
                                                        id="parentName" placeholder="Nh·∫≠p t√™n ph·ª• huynh">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="grade" class="form-label fw-semibold">L·ªõp h·ªçc</label>
                                                    <input type="text" class="form-control rounded-3 p-2" id="grade"
                                                        placeholder="Nh·∫≠p l·ªõp h·ªçc">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="addressStudent" class="form-label fw-semibold">ƒê·ªãa
                                                        ch·ªâ</label>
                                                    <input type="text" class="form-control rounded-3 p-2"
                                                        id="addressStudent" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="notes" class="form-label fw-semibold">Ghi ch√∫</label>
                                                    <textarea class="form-control rounded-3 p-2" id="notes"
                                                        placeholder="Nh·∫≠p ghi ch√∫ (n·∫øu c√≥)"></textarea>
                                                </div>
                                            </div>

                                        </div>
                                    </div>

                                    <button type="submit" class="btn w-100 py-2 rounded-3 text-white"
                                        style="background-color: #CE1212;">ƒêƒÉng k√Ω</button>
                                </form>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const registerForm = document.querySelector("#registerForm");
                const loginRegisterTabs = new bootstrap.Tab(document.querySelector("#login-tab"));

                registerForm.addEventListener("submit", async function (event) {
                    event.preventDefault();

                    // L·∫•y d·ªØ li·ªáu t·ª´ form
                    const fullname = document.getElementById("registerName").value;
                    const phoneNumber = document.getElementById("registerPhone").value;
                    const email = document.getElementById("registerEmail").value;
                    const password = document.getElementById("registerPassword").value;
                    const username = document.getElementById("username").value;
                    const role = document.getElementById("registerRole").value;

                    // Ki·ªÉm tra m·∫≠t kh·∫©u c√≥ kh·ªõp kh√¥ng
                    if (password.length < 6) {
                        Swal.fire({
                            title: "L·ªói!",
                            text: "M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±!",
                            icon: "error",
                            confirmButtonText: "Th·ª≠ l·∫°i"
                        });
                        return;
                    }

                    // T·∫°o ƒë·ªëi t∆∞·ª£ng d·ªØ li·ªáu g·ª≠i ƒëi
                    let requestBody = {
                        username: username,
                        fullname: fullname,
                        phoneNumber: phoneNumber,
                        email: email,
                        password: password,
                        role: role
                    };

                    // N·∫øu role l√† Tutor, th√™m th√¥ng tin Tutor
                    if (role === "Tutor") {
                        requestBody.gender = document.getElementById("gender").value === "1";
                        requestBody.dateOfBirth = document.getElementById("dateOfBirth").value;
                        requestBody.address = document.getElementById("address").value;
                        requestBody.qualification = document.getElementById("qualification").value;
                        requestBody.experience = document.getElementById("experience").value;
                        requestBody.bio = document.getElementById("bio").value;
                    }

                    // N·∫øu role l√† Student, th√™m th√¥ng tin Student
                    if (role === "Student") {
                        requestBody.parentName = document.getElementById("parentName").value;
                        requestBody.grade = document.getElementById("grade").value;
                        requestBody.address = document.getElementById("addressStudent").value;
                        requestBody.notes = document.getElementById("notes").value;
                    }

                    // Ki·ªÉm tra log d·ªØ li·ªáu g·ª≠i ƒëi
                    console.log("D·ªØ li·ªáu g·ª≠i l√™n:", JSON.stringify(requestBody, null, 2));

                    // G·ª≠i request ƒë·∫øn backend
                    const response = await fetch("http://157.66.24.154:8080/users/register", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify(requestBody),
                    });

                    const result = await response.text();
                    if (response.ok) {
                        Swal.fire({
                            title: "ƒêƒÉng k√Ω th√†nh c√¥ng!",
                            text: "B√¢y gi·ªù b·∫°n c√≥ th·ªÉ ƒëƒÉng nh·∫≠p.",
                            icon: "success",
                            confirmButtonText: "ƒêƒÉng nh·∫≠p ngay"
                        }).then(() => {
                            registerForm.reset();
                            loginRegisterTabs.show();
                        });
                    } else {
                        Swal.fire({
                            title: "L·ªói!",
                            text: result,
                            icon: "error",
                            confirmButtonText: "Th·ª≠ l·∫°i"
                        });
                    }
                });
            });


        </script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const forgotPasswordLink = document.getElementById("forgotPasswordLink");
                const forgotPasswordModal = new bootstrap.Modal(document.getElementById("forgotPasswordModal"));

                forgotPasswordLink.addEventListener("click", function (event) {
                    event.preventDefault(); // NgƒÉn ch·∫∑n chuy·ªÉn h∆∞·ªõng trang
                    forgotPasswordModal.show(); // M·ªü modal qu√™n m·∫≠t kh·∫©u
                });
            });
            document.addEventListener("DOMContentLoaded", function () {
                const loginModal = document.getElementById("loginModal");

                // L·∫Øng nghe s·ª± ki·ªán khi modal b·ªã ƒë√≥ng
                loginModal.addEventListener("hidden.bs.modal", function () {
                    // Xo√° l·ªõp m·ªù (n·∫øu c√≥)
                    document.querySelectorAll(".modal-backdrop").forEach(el => el.remove());
                    document.body.classList.remove("modal-open"); // Xo√° class modal-open
                    document.body.style.overflow = ""; // Reset l·∫°i overflow
                });
            });

        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js"></script>

    </main>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const user = JSON.parse(localStorage.getItem("user"));

            if (!user) {
                // L∆∞u tr·∫°ng th√°i v√†o localStorage ƒë·ªÉ bi·∫øt c·∫ßn hi·ªÉn th·ªã modal ƒëƒÉng nh·∫≠p
                localStorage.setItem("requireLogin", "true");

                Swal.fire({
                    icon: 'warning',
                    title: 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ xem Th·ªùi Kh√≥a Bi·ªÉu!',
                    text: 'B·∫°n s·∫Ω ƒë∆∞·ª£c chuy·ªÉn v·ªÅ trang ch√≠nh ƒë·ªÉ ƒëƒÉng nh·∫≠p.',
                    showConfirmButton: true
                }).then(() => {
                    window.location.href = "index.html"; // Chuy·ªÉn v·ªÅ trang index
                });
            }
        });
        document.addEventListener("DOMContentLoaded", function () {
            if (window.location.pathname.includes("student-schedule.html")) {
                const user = JSON.parse(localStorage.getItem("user"));

                if (!user) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ xem Th·ªùi Kh√≥a Bi·ªÉu!',
                        showConfirmButton: true
                    }).then(() => {
                        window.location.href = "index.html"; // Chuy·ªÉn h∆∞·ªõng v·ªÅ trang ch√≠nh n·∫øu ch∆∞a ƒëƒÉng nh·∫≠p
                    });
                }
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            const user = JSON.parse(localStorage.getItem("user"));
            const authButton = document.getElementById("authButton");
            const userDropdownButton = document.getElementById("userDropdownButton");
            const userDropdown = document.getElementById("userDropdown");
            const userId = JSON.parse(localStorage.getItem("userID"));
            const role = localStorage.getItem("role");
            console.log("User: ", userId);
            if (!userId) {
                event.preventDefault();
                Swal.fire({
                    icon: 'warning',
                    title: 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ th√™m b√†i vi·∫øt.',
                    showConfirmButton: true
                });
                loginModal.show();
                return;
            }
            if (user) {
                userDropdownButton.textContent = user.username;
                userDropdown.classList.remove("d-none");
            } else {
                userDropdown.classList.add("d-none");
                authButton.classList.remove("d-none");
            }

            const userData = JSON.parse(userId);
            const loggedInUserId = userId;  // L·∫•y userId t·ª´ th√¥ng tin ng∆∞·ªùi d√πng trong localStorage
            const loggedInUserRole = role;
            const yearSelect = document.getElementById('year-select');
            const weekSelect = document.getElementById('week-select');
            const scheduleBody = document.getElementById("schedule-body");

            let studentSchedule = []; // L∆∞u tr·ªØ d·ªØ li·ªáu l·ªãch h·ªçc t·ª´ API
            // X√°c ƒë·ªãnh API c·∫ßn g·ªçi
            let apiUrl = "";

            if (loggedInUserRole === "Student") {
                apiUrl = `http://157.66.24.154:8080/api/student/getSchedule/${loggedInUserId}`;
            } else if (loggedInUserRole === "Tutor") {
                apiUrl = `http://157.66.24.154:8080/api/tutor/getSchedule/${loggedInUserId}`;
            } else {
                console.error("Kh√¥ng th·ªÉ x√°c ƒë·ªãnh vai tr√≤ c·ªßa ng∆∞·ªùi d√πng.");
            }


            // **G·ªçi API ƒë·ªÉ l·∫•y d·ªØ li·ªáu l·ªãch h·ªçc c·ªßa h·ªçc sinh**
            fetch(apiUrl)

                .then(response => response.json())
                .then(data => {
                    console.log("D·ªØ li·ªáu tr·∫£ v·ªÅ t·ª´ API:", data); // Log d·ªØ li·ªáu tr·∫£ v·ªÅ t·ª´ API ƒë·ªÉ ki·ªÉm tra
                    studentSchedule = data.map(entry => ({
                        date: new Date(entry.date), // Chuy·ªÉn th√†nh object Date
                        subjectname: entry.subjectName,
                        classname: entry.className,  // L∆∞u √Ω s·ª≠ d·ª•ng ƒë√∫ng thu·ªôc t√≠nh
                        startTime: entry.startTime,
                        endTime: entry.endTime
                    }));
                    setupYearAndWeekDropdowns();
                    updateSchedule(); // Hi·ªÉn th·ªã l·ªãch ban ƒë·∫ßu
                })
                .catch(error => {
                    console.warn('Kh√¥ng c√≥ d·ªØ li·ªáu l·ªãch h·ªçc ho·∫∑c l·ªói k·∫øt n·ªëi:', error);
                    studentSchedule = []; 
                    setupYearAndWeekDropdowns();
                    updateSchedule();
                });


            // **H√†m t·∫°o dropdown ch·ªçn nƒÉm & tu·∫ßn**
            function setupYearAndWeekDropdowns() {
                const currentYear = new Date().getFullYear();
                for (let year = currentYear - 5; year <= currentYear + 5; year++) {
                    let option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    if (year === currentYear) option.selected = true;
                    yearSelect.appendChild(option);
                }

                function generateWeeks(year) {
                    weekSelect.innerHTML = ''; // X√≥a danh s√°ch tu·∫ßn c≈©
                    let firstDayOfYear = new Date(year, 0, 1); // Ng√†y 01/01 c·ªßa nƒÉm
                    let firstSunday = new Date(firstDayOfYear);
                    firstSunday.setDate(firstSunday.getDate() + (7 - firstSunday.getDay())); // Ch·ªß Nh·∫≠t ƒë·∫ßu ti√™n c·ªßa nƒÉm

                    let currentTime = new Date().getTime();
                    let currentWeekFound = false;
                    let weekNumber = 1;
                    let hasWeeks = false;

                    // **Tu·∫ßn ƒë·∫ßu ti√™n: 01/01 ƒë·∫øn Ch·ªß Nh·∫≠t ƒë·∫ßu ti√™n**
                    let mondayOfWeek = new Date(firstDayOfYear);
                    let sundayOfWeek = new Date(firstSunday);

                    while (mondayOfWeek.getFullYear() === year) {
                        let startStr = mondayOfWeek.toLocaleDateString('vi-VN', { day: '2-digit', month: '2-digit' });
                        let endStr = sundayOfWeek.toLocaleDateString('vi-VN', { day: '2-digit', month: '2-digit' });

                        let option = document.createElement('option');
                        option.value = `${mondayOfWeek.getTime()} - ${sundayOfWeek.getTime()}`;
                        option.textContent = `${startStr} ƒë·∫øn ${endStr}`;
                        hasWeeks = true;

                        // **T·ª± ƒë·ªông ch·ªçn tu·∫ßn hi·ªán t·∫°i**
                        if (!currentWeekFound && currentTime >= mondayOfWeek.getTime() && currentTime <= sundayOfWeek.getTime()) {
                            option.selected = true;
                            currentWeekFound = true;
                        }

                        weekSelect.appendChild(option);
                        weekNumber++;

                        // **Chuy·ªÉn sang tu·∫ßn ti·∫øp theo (Th·ª© Hai - Ch·ªß Nh·∫≠t)**
                        mondayOfWeek = new Date(sundayOfWeek);
                        mondayOfWeek.setDate(sundayOfWeek.getDate() + 1); // Sang Th·ª© Hai
                        sundayOfWeek = new Date(mondayOfWeek);
                        sundayOfWeek.setDate(mondayOfWeek.getDate() + 6); // Ch·ªß Nh·∫≠t
                    }

                    // **N·∫øu kh√¥ng c√≥ tu·∫ßn n√†o, hi·ªÉn th·ªã l·ªói**
                    if (!hasWeeks) {
                        console.error("Kh√¥ng t√¨m th·∫•y tu·∫ßn h·ª£p l·ªá!");
                        let defaultOption = document.createElement('option');
                        defaultOption.value = "";
                        defaultOption.textContent = "L·ªói t·∫°o tu·∫ßn! Ki·ªÉm tra console";
                        defaultOption.selected = true;
                        weekSelect.appendChild(defaultOption);
                    }

                    updateSchedule(); // Hi·ªÉn th·ªã l·ªãch m·∫∑c ƒë·ªãnh
                }

                generateWeeks(currentYear);

                yearSelect.addEventListener('change', function () {
                    generateWeeks(parseInt(this.value));
                    updateSchedule();
                });

                weekSelect.addEventListener('change', updateSchedule);
            }

            // **H√†m c·∫≠p nh·∫≠t l·ªãch h·ªçc theo tu·∫ßn**
            function updateSchedule() {
                scheduleBody.innerHTML = "";
                const days = ["MON", "TUE", "WED", "THU", "FRI", "SAT", "SUN"];
                const dayDates = {};  // Store dates for each day

                // Get the start and end of the week from the selected week
                let [weekStart, weekEnd] = weekSelect.value.split(" - ").map(ts => new Date(parseInt(ts)));

                // Calculate the date for each day of the week
                days.forEach((day, index) => {
                    let date = new Date(weekStart);
                    date.setDate(weekStart.getDate() + index); // Increment by day index
                    dayDates[day] = date.toLocaleDateString('en-GB'); // Format as dd/mm
                });

                // Update the header to show the dates
                const headerRow = document.querySelector('thead tr');
                days.forEach((day, index) => {
                    const th = headerRow.querySelector(`th:nth-child(${index + 1})`);
                    th.innerText = `${day} (${dayDates[day]})`;  // Show both day and date
                });

                let scheduleData = {};
                days.forEach(day => scheduleData[day] = []);

                // Process the schedule data and assign them to the correct day columns
                studentSchedule.forEach(entry => {
                    let date = entry.date;
                    let dayIndex = date.getDay();
                    let dayName = days[dayIndex === 0 ? 6 : dayIndex - 1];

                    if (date >= weekStart && date <= weekEnd) {
                        scheduleData[dayName].push({
                            subjectname: entry.subjectname,
                            classname: entry.classname,
                            startTime: entry.startTime,
                            endTime: entry.endTime
                        });
                    }
                });

                // Render the schedule data in the table
                let maxRows = Math.max(...Object.values(scheduleData).map(list => list.length), 1);
                for (let i = 0; i < maxRows; i++) {
                    let row = "<tr>";
                    days.forEach(day => {
                        if (scheduleData[day][i]) {
                            let entry = scheduleData[day][i];
                            row += `<td>${entry.subjectname} - ${entry.classname} <br> (${entry.startTime} - ${entry.endTime}) </td>`;
                        } else {
                            row += `<td> - </td>`;
                        }
                    });
                    row += "</tr>";
                    scheduleBody.innerHTML += row;
                }
            }
        });



    </script>

<footer id="footer" class="footer dark-background">
    <div class="container">
      <div class="row gy-3">
        <div class="col-lg-3 col-md-6 d-flex">
          <i class="bi bi-geo-alt icon"></i>
          <div class="address">
            <h4>ƒê·ªãa ch·ªâ</h4>
            <p>Khu C√¥ng ngh·ªá cao H√≤a L·∫°c, Km29 ƒê·∫°i l·ªô ThƒÉng Long</p>
            <p>Huy·ªán Th·∫°ch Th·∫•t, H√† N·ªôi</p>
            <p></p>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 d-flex">
          <i class="bi bi-telephone icon"></i>
          <div>
            <h4>Li√™n h·ªá</h4>
            <p>
              <strong>ƒêi·ªán tho·∫°i:</strong> <span>0788878117</span><br>
              <strong>Email:</strong> <span>edumatch0102@gmail.com</span><br>
            </p>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 d-flex">
          <i class="bi bi-clock icon"></i>
          <div>
            <h4>Th·ªùi gian m·ªü c·ª≠a</h4>
            <p>
              <strong>Th·ª© 2 - Th·ª© 6:</strong> <span>11AM - 23PM</span><br>
              <strong>Ch·ªß nh·∫≠t</strong>: <span>ƒê√≥ng c·ª≠a</span>
            </p>
          </div>
        </div>
        <div class="col-lg-3 col-md-6">
          <h4>Theo d√µi ch√∫ng t√¥i</h4>
          <div class="social-links d-flex">
            <a href="#" class="twitter"><i class="bi bi-twitter-x"></i></a>
            <a href="https://www.facebook.com/profile.php?id=61573150057127" class="facebook"><i
                class="bi bi-facebook"></i></a>
            <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
            <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
          </div>
        </div>

      </div>
    </div>

    <div class="container copyright text-center mt-4">
      <p>¬© <span>Copyright</span> <strong class="px-1 sitename">EDUMATCH</strong> <span>All Rights Reserved</span></p>
      <div class="credits">
        Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a> Distributed by <a
          href="https://themewagon.com">ThemeWagon</a>
      </div>
    </div>

  </footer>
    <!-- Scroll Top -->
    <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>

    <!-- Preloader -->
    <div id="preloader"></div>

    <!-- Vendor JS Files -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/php-email-form/validate.js"></script>
    <script src="assets/vendor/aos/aos.js"></script>
    <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
    <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="assets/js/auth.js"></script>


    <!-- Main JS File -->
    <script src="assets/js/main.js"></script>
</body>

</html>